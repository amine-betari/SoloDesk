{# templates/partials/sidebar.html.twig #}
<aside class="w-full md:w-64 bg-[#1F2732] md:min-h-screen flex flex-col" data-controller="mobile-menu">
    <div class="px-6 py-4 flex items-center justify-between md:block">
        <div>
            <div class="text-white text-2xl font-bold">SoloDesk</div>
            {% if app.user and app.user.company %}
                <div class="text-xs text-gray-400 mt-1 truncate">{{ app.user.company.name }}</div>
            {% endif %}
        </div>
        <button
            type="button"
            class="md:hidden inline-flex items-center justify-center w-9 h-9 rounded-md border border-[#2A3747] text-gray-300 hover:text-white hover:border-[#6cc7cd]"
            data-action="mobile-menu#toggle"
            aria-label="Toggle menu"
        >
            <svg data-mobile-menu-target="iconOpen" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
            <svg data-mobile-menu-target="iconClose" class="w-5 h-5 hidden" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
            </svg>
        </button>
    </div>

    <nav class="flex-1 px-2 space-y-2 hidden md:block" data-mobile-menu-target="panel">
        {% set menuItems = [
            {'route':'home', 'label':'Dashboard', 'icon':'home'},
            {'route':'app_project_index', 'label':'Projects', 'icon':'folder'},
            {'route':'app_estimate_index', 'label':'Pré-Estimations', 'icon':'file-text'},
            {'route':'app_payment_index', 'label':'Paiements', 'icon':'credit-card'},
            {'route':'app_sales_document_index', 'label':'Documents de Vente', 'icon':'file'},
            {'route':'app_client_index', 'label':'Clients', 'icon':'users'}
        ] %}

        {% for item in menuItems %}
            <a href="{{ path(item.route) }}"
               class="group flex items-center px-4 py-3 rounded-md transition-colors
               {% if app.request.attributes.get('_route') starts with item.route %}bg-[#2A3747] text-white font-semibold{% else %}text-gray-400 hover:bg-[#2A3747] hover:text-white{% endif %}">
                {# Icône simple avec Heroicons #}
                <svg class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    {% if item.icon == 'home' %}
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-4H9v4a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9z"/>
                    {% elseif item.icon == 'folder' %}
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 7h18M3 7v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V7M3 7l2-4h14l2 4"/>
                    {% elseif item.icon == 'file-text' %}
                        <path stroke-linecap="round" stroke-linejoin="round" d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM14 2v6h6"/>
                    {% elseif item.icon == 'credit-card' %}
                        <path stroke-linecap="round" stroke-linejoin="round" d="M2 6h20v12H2zM2 10h20"/>
                    {% elseif item.icon == 'file' %}
                        <path stroke-linecap="round" stroke-linejoin="round" d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/>
                    {% elseif item.icon == 'users' %}
                        <path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a4 4 0 0 0-4-4h-1M9 20h5v-2a4 4 0 0 0-4-4H9M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4z"/>
                    {% elseif item.icon == 'briefcase' %}
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10 6V5a2 2 0 0 1 2-2h0a2 2 0 0 1 2 2v1m-7 4h10m-11 4h12m-12 0v5a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-5m-12 0h12"/>
                    {% endif %}
                </svg>

                {{ item.label }}
            </a>
        {% endfor %}

        {# Section Entreprise #}
        <div class="mt-3 pt-3 border-t border-[#2A3747]">
            <a href="{{ path('app_company_edit') }}"
               class="group flex items-center px-4 py-3 rounded-md transition-colors
               {% if app.request.attributes.get('_route') starts with 'app_company_edit' %}bg-[#2A3747] text-white font-semibold{% else %}text-gray-400 hover:bg-[#2A3747] hover:text-white{% endif %}">
                <svg class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10 6V5a2 2 0 0 1 2-2h0a2 2 0 0 1 2 2v1m-7 4h10m-11 4h12m-12 0v5a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-5m-12 0h12"/>
                </svg>
                Entreprise
            </a>

            <a href="{{ path('app_templates_index') }}"
               class="group flex items-center ml-6 px-4 py-2 rounded-md transition-colors
               {% if app.request.attributes.get('_route') starts with 'app_templates' %}bg-[#2A3747] text-white font-semibold{% else %}text-gray-400 hover:bg-[#2A3747] hover:text-white{% endif %}">
                <svg class="w-4 h-4 mr-3 text-gray-400 group-hover:text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6zM14 2v6h6"/>
                </svg>
                Modèles
            </a>

            <a href="{{ path('app_settings') }}"
               class="group flex items-center ml-6 px-4 py-2 rounded-md transition-colors
               {% if app.request.attributes.get('_route') starts with 'app_settings' %}bg-[#2A3747] text-white font-semibold{% else %}text-gray-400 hover:bg-[#2A3747] hover:text-white{% endif %}">
                <svg class="w-4 h-4 mr-3 text-gray-400 group-hover:text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0z"/>
                </svg>
                Paramètres
            </a>
        </div>

        {% if app.user %}
            <form method="post" action="{{ path('app_logout') }}" class="mt-3 pt-3 border-t border-[#2A3747]">
                <input type="hidden" name="_csrf_token" value="{{ csrf_token('logout') }}">
                <button type="submit"
                        class="group flex items-center w-full px-4 py-3 rounded-md transition-colors text-gray-400 hover:bg-[#2A3747] hover:text-white">
                    <svg class="w-5 h-5 mr-3 text-gray-400 group-hover:text-white" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1"/>
                    </svg>
                    Déconnexion
                </button>
            </form>
        {% endif %}
    </nav>
</aside>
